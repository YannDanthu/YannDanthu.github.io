= Un Sens'it, un Rolling Spider et Meteor sont dans un bateau
:hp-tags: Sensit, IoT, Sigfox, Meteor, Parrot, Rolling Spider

Comme vous l'avez peut-eêtre lu dans mon précédent billet http://anthonnyquerouil.fr/2015/08/24/Sensit-mon-petit-objet-connecte.html, j'ai récemment fait l'acquisition d'un Sens'it. 

image::https://cloud.githubusercontent.com/assets/2006548/9440843/9e9e12bc-4a72-11e5-9485-cc94a6735fbf.JPG[]

J'ai aussi depuis peu un Rolling-spider que je m'étais procuré dans le but de le controller via un peu de code JS (tout ça à cause de http://twitter.com/k33g_org[@k33g_org]). L'heure est venue de mixer tout ça !

image::https://pbs.twimg.com/media/CNiIQfqWoAAhK9m.jpg[]

== L'objectif

L'objectif est plutôt simple, double cliquer sur le Sens'it et faire décoller le Rolling-spider.

Pour ce faire, voici ce qu'il nous faut :

* Un Sens'it,
* Un Parrot Rolling Spider,
* Un framework JS permettant de controller le spider (on utilisera https://github.com/voodootikigod/node-rolling-spider[node-rolling-spider]),
* Un peu de Meteor pour lier le tout.


== L'architecture


image::https://cloud.githubusercontent.com/assets/2006548/9583557/61447d4e-500c-11e5-81c0-7af694b0525e.png[title=Architecture cible]

1. Le Sens'it va transmettre un message sur le réseau SIGFOX,
2. Les serveurs SIGFOX vont communiquer aux serveurs AXIBLE qu'un message button a été envoyé,
3. AXIBLE va appelé l'URL de Callback que nous aurons défini dans l'interface d'administration,
4. Ce callback pointera sur une application *sensit.meteor.com* que nous aurons déployée au préalable,
5. Cette dernière enregistrera une trace de l'appel dans une collection Mongo,
6. Notre application cliente établira une connexion DDP avec l'application *sensit.meteor.com*, et observera les changements effectués sur cette collection,
7. Au premier changement détecté, on décolle.
